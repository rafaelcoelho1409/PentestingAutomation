#!/bin/bash
LINKFINDER() {
    stage="LINKFINDER"
    source ${TOOLS_PATH}/virtual_environments/linkfinder_env/bin/activate
    cd ${TOOLS_PATH}/LinkFinder
    if [[ ! -d "${folder}/linkfinder" ]]; then
        mkdir "${folder}/linkfinder"
    fi
    #stage 1: RECONNAISSANCE/katana.txt
    echo "STAGE 1"
    if [[ -e "${rec_folder}/katana.txt" ]]; then
        for subdomain in $(\
            cat "${rec_folder}/katana.txt" | \
            grep "\.js"); do
        #    subdomain_txt=$(echo "${subdomain}" | \
        #        sed -e 's|^http://||' -e 's|^https://||')
            echo -e "${subdomain}\n\n" >> "${folder}/linkfinder/katana.txt"
            python3 linkfinder.py -i ${subdomain} \
                -o cli  >> "${folder}/linkfinder/katana.txt"
            printf '%*s' 70 | tr ' ' '-' >> "${folder}/linkfinder/katana.txt"
            echo -e "\n" >> "${folder}/linkfinder/katana.txt"
        done
    fi
    deactivate
}