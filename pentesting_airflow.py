import airflow
from airflow import DAG
from airflow.operators.bash import BashOperator
from airflow.operators.dummy import DummyOperator
from airflow.models import Variable
import datetime as dt
import os

#---VARIABLES---
domains = Variable.get(
    "domains", 
    default_var = "")
folder = Variable.get(
    "folder", 
    default_var = "")
tools_path = Variable.get(
    "tools_path", 
    default_var = "~/TOOLS/EchoStriker")

airflow_args = {
    'owner': 'rafaelcoelho',
    'start_date': dt.datetime.now() + dt.timedelta(minutes = 1),
    'depends_on_past': False,
    #'retries': 5,
    #'retries_delay': dt.timedelta(seconds = 30)
    }

dag = DAG(
    dag_id = 'pentesting_dag',
    default_args = airflow_args,
    max_active_tasks = 32)


#---STAGES---
#--------------------------
#>>>---RECONNAISSANCE---<<<
#--------------------------
_subfinder = BashOperator(
    task_id = "R-SUBFINDER",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a SUBFINDER",
    dag = dag
)

_httpx = BashOperator(
    task_id = "R-HTTPX",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a HTTPX",
    dag = dag
)

_dnsreaper = BashOperator(
    task_id = "R-DNSREAPER",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a DNSREAPER",
    dag = dag
)

_waybackurls = BashOperator(
    task_id = "R-WAYBACKURLS",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a WAYBACKURLS",
    env = {'DOMAINS': domains, 'FOLDER': folder},
    dag = dag
)

_dnsx = BashOperator(
    task_id = "R-DNSX",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a DNSX",
    env = {'DOMAINS': domains, 'FOLDER': folder},
    dag = dag
)

_api_discovery = BashOperator(
    task_id = "R-API_DISCOVERY",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a API_DISCOVERY",
    dag = dag
)

_naabu = BashOperator(
    task_id = "R-NAABU",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a NAABU",
    dag = dag
)

_nmap = BashOperator(
    task_id = "R-NMAP",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a NMAP",
    dag = dag
)

_directories = BashOperator(
    task_id = "R-DIRECTORIES",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a DIRECTORIES",
    dag = dag
)

_katana = BashOperator(
    task_id = "R-KATANA",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a KATANA",
    dag = dag
)

_final_data_version = BashOperator(
    task_id = "R-FINAL_DATA_VERSION",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a FINAL_DATA_VERSION",
    env = {'DOMAINS': domains, 'FOLDER': folder},
    dag = dag
)

_bruteforce_subdomains = BashOperator(
    task_id = "R-BRUTEFORCE_SUBDOMAINS",
    bash_command = f"{tools_path}/reconnaissance.sh -d {domains} -f {folder} -a BRUTEFORCE_SUBDOMAINS",
    env = {'DOMAINS': domains, 'FOLDER': folder},
    dag = dag
)

#-----------------------
#>>>---NUCLEI SCAN---<<<
#-----------------------
_n01_nuclei_api = BashOperator(
    task_id = "N01_NUCLEI_API",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N01_NUCLEI_API",
    env = {'FOLDER': folder},
    dag = dag
)

_n01_nuclei_graphql = BashOperator(
    task_id = "N01_NUCLEI_GRAPHQL",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N01_NUCLEI_GRAPHQL",
    env = {'FOLDER': folder},
    dag = dag
)

_n02_nuclei_open_redirect = BashOperator(
    task_id = "N02_NUCLEI_OPEN_REDIRECT",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N02_NUCLEI_OPEN_REDIRECT",
    env = {'FOLDER': folder},
    dag = dag
)

_n03_nuclei_idor = BashOperator(
    task_id = "N03_NUCLEI_IDOR",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N03_NUCLEI_IDOR",
    env = {'FOLDER': folder},
    dag = dag
)

_n04_nuclei_xxe = BashOperator(
    task_id = "N04_NUCLEI_XXE",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N04_NUCLEI_XXE",
    env = {'FOLDER': folder},
    dag = dag
)

_n05_nuclei_rce = BashOperator(
    task_id = "N05_NUCLEI_RCE",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N05_NUCLEI_RCE",
    env = {'FOLDER': folder},
    dag = dag
)

_n06_nuclei_file_inclusion = BashOperator(
    task_id = "N06_NUCLEI_FILE_INCLUSION",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N06_NUCLEI_FILE_INCLUSION",
    env = {'FOLDER': folder},
    dag = dag
)

_n07_nuclei_cookie = BashOperator(
    task_id = "N07_NUCLEI_COOKIE",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N07_NUCLEI_COOKIE",
    env = {'FOLDER': folder},
    dag = dag
)

_n08_nuclei_oauth = BashOperator(
    task_id = "N08_NUCLEI_OAUTH",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N08_NUCLEI_OAUTH",
    env = {'FOLDER': folder},
    dag = dag
)

_n09_nuclei_takeover = BashOperator(
    task_id = "N09_NUCLEI_TAKEOVER",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N09_NUCLEI_TAKEOVER",
    env = {'FOLDER': folder},
    dag = dag
)

_n10_nuclei_traversal = BashOperator(
    task_id = "N10_NUCLEI_TRAVERSAL",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N10_NUCLEI_TRAVERSAL",
    env = {'FOLDER': folder},
    dag = dag
)

_n11_nuclei_crlf_injection = BashOperator(
    task_id = "N11_NUCLEI_CRLF_INJECTION",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N11_NUCLEI_CRLF_INJECTION",
    env = {'FOLDER': folder},
    dag = dag
)

_n12_nuclei_xss = BashOperator(
    task_id = "N12_NUCLEI_XSS",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N12_NUCLEI_XSS",
    env = {'FOLDER': folder},
    dag = dag
)

_n13_nuclei_template_injection = BashOperator(
    task_id = "N13_NUCLEI_TEMPLATE_INJECTION",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N13_NUCLEI_TEMPLATE_INJECTION",
    env = {'FOLDER': folder},
    dag = dag
)

_n14_nuclei_ssrf = BashOperator(
    task_id = "N14_NUCLEI_SSRF",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N14_NUCLEI_SSRF",
    env = {'FOLDER': folder},
    dag = dag
)

_n15_nuclei_sql_injection = BashOperator(
    task_id = "N15_NUCLEI_SQL_INJECTION",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N15_NUCLEI_SQL_INJECTION",
    env = {'FOLDER': folder},
    dag = dag
)

_n16_nuclei_http_cnvd = BashOperator(
    task_id = "N16_NUCLEI_HTTP_CNVD",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N16_NUCLEI_HTTP_CNVD",
    env = {'FOLDER': folder},
    dag = dag
)

_n17_nuclei_http_cves = BashOperator(
    task_id = "N17_NUCLEI_HTTP_CVES",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N17_NUCLEI_HTTP_CVES",
    env = {'FOLDER': folder},
    dag = dag
)

_n18_nuclei_http_default_logins = BashOperator(
    task_id = "N18_NUCLEI_HTTP_DEFAULT_LOGINS",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N18_NUCLEI_HTTP_DEFAULT_LOGINS",
    env = {'FOLDER': folder},
    dag = dag
)

_n19_nuclei_http_exposed_panels = BashOperator(
    task_id = "N19_NUCLEI_HTTP_EXPOSED_PANELS",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N19_NUCLEI_HTTP_EXPOSED_PANELS",
    env = {'FOLDER': folder},
    dag = dag
)

_n20_nuclei_http_exposures = BashOperator(
    task_id = "N20_NUCLEI_HTTP_EXPOSURES",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N20_NUCLEI_HTTP_EXPOSURES",
    env = {'FOLDER': folder},
    dag = dag
)

_n21_nuclei_http_misconfiguration = BashOperator(
    task_id = "N21_NUCLEI_HTTP_MISCONFIGURATION",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N21_NUCLEI_HTTP_MISCONFIGURATION",
    env = {'FOLDER': folder},
    dag = dag
)

_n22_nuclei_http_technologies = BashOperator(
    task_id = "N22_NUCLEI_HTTP_TECHNOLOGIES",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N22_NUCLEI_HTTP_TECHNOLOGIES",
    env = {'FOLDER': folder},
    dag = dag
)

_n23_nuclei_http_vulnerabilities = BashOperator(
    task_id = "N23_NUCLEI_HTTP_VULNERABILITIES",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N23_NUCLEI_HTTP_VULNERABILITIES",
    env = {'FOLDER': folder},
    dag = dag
)

_n24_nuclei_javascript = BashOperator(
    task_id = "N24_NUCLEI_JAVASCRIPT",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N24_NUCLEI_JAVASCRIPT",
    env = {'FOLDER': folder},
    dag = dag
)

_n25_nuclei_ssl = BashOperator(
    task_id = "N25_NUCLEI_SSL",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N25_NUCLEI_SSL",
    env = {'FOLDER': folder},
    dag = dag
)

_n26_nuclei_dast = BashOperator(
    task_id = "N26_NUCLEI_DAST",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N26_NUCLEI_DAST",
    env = {'FOLDER': folder},
    dag = dag
)

_n27_nuclei_headless = BashOperator(
    task_id = "N27_NUCLEI_HEADLESS",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N27_NUCLEI_HEADLESS",
    env = {'FOLDER': folder},
    dag = dag
)

_n28_nuclei_dns = BashOperator(
    task_id = "N28_NUCLEI_DNS",
    bash_command = f"{tools_path}/nuclei_scan.sh -f {folder} -a N28_NUCLEI_DNS",
    env = {'FOLDER': folder},
    dag = dag
)

#---------------------------------

#--------------------
#>>>---CLUSTERS---<<<
#--------------------
_cluster1 = DummyOperator(
    task_id = "CLUSTER1",
    #trigger_rule = "all_success",
    dag = dag
)

_cluster2 = DummyOperator(
    task_id = "CLUSTER2",
    #trigger_rule = "all_success",
    dag = dag
)

_cluster3 = DummyOperator(
    task_id = "CLUSTER3",
    #trigger_rule = "all_success",
    dag = dag
)

_cluster4 = DummyOperator(
    task_id = "CLUSTER4",
    #trigger_rule = "all_success",
    dag = dag
)

#-------------------
#>>>---DUMMIES---<<<
#-------------------
_v01_cors = DummyOperator(
    task_id = "V01_CORS",
    dag = dag
)

_v02_host_header_injection = DummyOperator(
    task_id = "V02_HOST_HEADER_INJECTION",
    dag = dag
)

_v03_csrf = DummyOperator(
    task_id = "V03_CSRF",
    dag = dag
)

_v04_request_smuggling = DummyOperator(
    task_id = "V04_REQUEST_SMUGGLING",
    dag = dag
)

_v05_api = DummyOperator(
    task_id = "V05_API",
    dag = dag
)

_v06_open_redirect = DummyOperator(
    task_id = "V06_OPEN_REDIRECT",
    dag = dag
)

_v07_idor = DummyOperator(
    task_id = "V07_IDOR",
    dag = dag
)

_v08_xxe = DummyOperator(
    task_id = "V08_XXE",
    dag = dag
)

_v09_rce = DummyOperator(
    task_id = "V09_RCE",
    dag = dag
)

_v10_file_inclusion = DummyOperator(
    task_id = "V10_FILE_INCLUSION",
    dag = dag
)

_v11_cookie = DummyOperator(
    task_id = "V11_COOKIE",
    dag = dag
)

_v12_oauth = DummyOperator(
    task_id = "V12_OAUTH",
    dag = dag
)

_v13_takeover = DummyOperator(
    task_id = "V13_TAKEOVER",
    dag = dag
)

_v14_traversal = DummyOperator(
    task_id = "V14_TRAVERSAL",
    dag = dag
)

_v15_crlf_injection = DummyOperator(
    task_id = "V15_CRLF_INJECTION",
    dag = dag
)

_v16_403_bypass = DummyOperator(
    task_id = "V16_403_BYPASS",
    dag = dag
)

_v17_favicon = DummyOperator(
    task_id = "V17_FAVICON",
    dag = dag
)

_v18_xss = DummyOperator(
    task_id = "V18_XSS",
    dag = dag
)

_v19_template_injection = DummyOperator(
    task_id = "V19_TEMPLATE_INJECTION",
    dag = dag
)

_v20_ssrf = DummyOperator(
    task_id = "V20_SSRF",
    dag = dag
)

_v21_hidden_parameters = DummyOperator(
    task_id = "V21_HIDDEN_PARAMETERS",
    dag = dag
)

_v22_sql_injection = DummyOperator(
    task_id = "V22_SQL_INJECTION",
    dag = dag
)


#---------------------------
#>>>---VULNERABILITIES---<<<
#---------------------------
_v01_cors_misconfiguration_spyhunt = BashOperator(
    task_id = "V01_CORS_MISCONFIGURATION_SPYHUNT",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V01_CORS_MISCONFIGURATION_SPYHUNT",
    env = {'FOLDER': folder},
    dag = dag
)

_v01_cors_corsy = BashOperator(
    task_id = "V01_CORS_CORSY",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V01_CORS_CORSY",
    env = {'FOLDER': folder},
    dag = dag
)

_v02_host_header_injection_ffuf = BashOperator(
    task_id = "V02_HOST_HEADER_INJECTION_FFUF",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V02_HOST_HEADER_INJECTION_FFUF",
    env = {'FOLDER': folder},
    dag = dag
)

_v03_csrf_xsrfprobe = BashOperator(
    task_id = "V03_CSRF_XSRFPROBE",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V03_CSRF_XSRFPROBE",
    env = {'FOLDER': folder},
    dag = dag
)

_v04_request_smuggling_smugglefuzz = BashOperator(
    task_id = "V04_REQUEST_SMUGGLING_SMUGGLEFUZZ",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V04_REQUEST_SMUGGLING_SMUGGLEFUZZ",
    env = {'FOLDER': folder},
    dag = dag
)

_v05_api_graphql_endpoints = BashOperator(
    task_id = "V05_API_GRAPHQL_ENDPOINTS",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V05_API_GRAPHQL_ENDPOINTS",
    env = {'FOLDER': folder},
    dag = dag
)

_v05_api_goctopus = BashOperator(
    task_id = "V05_API_GOCTOPUS",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V05_API_GOCTOPUS",
    env = {'FOLDER': folder},
    dag = dag
)

_v05_api_graphw00f = BashOperator(
    task_id = "V05_API_GRAPHW00F",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V05_API_GRAPHW00F",
    env = {'FOLDER': folder},
    dag = dag
)

_v13_takeover_subzy = BashOperator(
    task_id = "V13_TAKEOVER_SUBZY",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V13_TAKEOVER_SUBZY",
    env = {'FOLDER': folder},
    dag = dag
)

_v13_takeover_mx_spf = BashOperator(
    task_id = "V13_TAKEOVER_MX_SPF",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V13_TAKEOVER_MX_SPF",
    env = {'FOLDER': folder},
    dag = dag
)

_v16_403_bypass_403jump = BashOperator(
    task_id = "V16_403_BYPASS_403JUMP",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V16_403_BYPASS_403JUMP",
    env = {'FOLDER': folder},
    dag = dag
)

_v17_favicon_favfreak = BashOperator(
    task_id = "V17_FAVICON_FAVFREAK",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V17_FAVICON_FAVFREAK",
    env = {'FOLDER': folder},
    dag = dag
)

_v17_favicon_favirecon = BashOperator(
    task_id = "V17_FAVICON_FAVIRECON",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V17_FAVICON_FAVIRECON",
    env = {'FOLDER': folder},
    dag = dag
)

_v18_xss_dalfox = BashOperator(
    task_id = "V18_XSS_DALFOX",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V18_XSS_DALFOX",
    env = {'FOLDER': folder},
    dag = dag
)

_v18_xss_xsstrike = BashOperator(
    task_id = "V18_XSS_XSSTRIKE",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V18_XSS_XSSTRIKE",
    env = {'FOLDER': folder},
    dag = dag
)

_v18_xss_gxss = BashOperator(
    task_id = "V18_XSS_GXSS",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V18_XSS_GXSS",
    env = {'FOLDER': folder},
    dag = dag
)

_v19_template_injection_tinja = BashOperator(
    task_id = "V19_TEMPLATE_INJECTION_TINJA",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V19_TEMPLATE_INJECTION_TINJA",
    env = {'FOLDER': folder},
    dag = dag
)

_v20_ssrf_surf = BashOperator(
    task_id = "V20_SSRF_SURF",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V20_SSRF_SURF",
    env = {'FOLDER': folder},
    dag = dag
)

_v21_hidden_parameters_arjun = BashOperator(
    task_id = "V21_HIDDEN_PARAMETERS_ARJUN",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V21_HIDDEN_PARAMETERS_ARJUN",
    env = {'FOLDER': folder},
    dag = dag
)

_v22_sql_injection_ghauri = BashOperator(
    task_id = "V22_SQL_INJECTION_GHAURI",
    bash_command = f"{tools_path}/vulnerabilities.sh -f {folder} -a V22_SQL_INJECTION_GHAURI",
    env = {'FOLDER': folder},
    dag = dag
)
#------------------------------------------



#---DAG EXECUTION---
_subfinder >> [
    _httpx, 
    _dnsreaper, 
    _dnsx, 
    _waybackurls]
_waybackurls >> _final_data_version
_httpx >> [
    _naabu, 
    _bruteforce_subdomains,
    _api_discovery]
_naabu >> _nmap
_api_discovery >> _final_data_version
_bruteforce_subdomains >> _directories >> _katana >> _final_data_version
#After FINAL_DATA_VERSION
_final_data_version >> _cluster1
#CLUSTER1
_cluster1 >> [
    _v06_open_redirect,
    _v07_idor,
    _v08_xxe,
    _v09_rce,
    _v10_file_inclusion,
    _v11_cookie,
    _v12_oauth,
    _v13_takeover,
    _v14_traversal,
    _v15_crlf_injection,
    _v16_403_bypass,
    _v17_favicon
]
_v06_open_redirect >> _n02_nuclei_open_redirect
_v07_idor >> _n03_nuclei_idor
_v08_xxe >> _n04_nuclei_xxe
_v09_rce >> _n05_nuclei_rce
_v10_file_inclusion >> _n06_nuclei_file_inclusion
_v11_cookie >> _n07_nuclei_cookie
_v12_oauth >> _n08_nuclei_oauth
_v13_takeover >> [
    _n09_nuclei_takeover,
    _v13_takeover_subzy,
    _v13_takeover_mx_spf
]
_v14_traversal >> _n10_nuclei_traversal
_v15_crlf_injection >> _n11_nuclei_crlf_injection
_v16_403_bypass >> [
    _v16_403_bypass_403jump
]
_v17_favicon >> [
    _v17_favicon_favfreak,
    _v17_favicon_favirecon
]
#CLUSTER2
_cluster1 >> _cluster2
_cluster2 >> [
    _n16_nuclei_http_cnvd,
    _n17_nuclei_http_cves,
    _n18_nuclei_http_default_logins,
    _n19_nuclei_http_exposed_panels,
    _n20_nuclei_http_exposures,
    _n21_nuclei_http_misconfiguration,
    _n22_nuclei_http_technologies,
    _n23_nuclei_http_vulnerabilities,
    _n24_nuclei_javascript,
    _n25_nuclei_ssl,
    _n26_nuclei_dast,
    _n27_nuclei_headless,
    _n28_nuclei_dns
]
#CLUSTER3
_cluster2 >> _cluster3
_cluster3 >> [
    _v02_host_header_injection,
    _v05_api,
    _v19_template_injection,
    _v21_hidden_parameters
]
_v02_host_header_injection >> _v02_host_header_injection_ffuf
_v05_api >> [
    _n01_nuclei_api,
    _n01_nuclei_graphql,
    _v05_api_graphql_endpoints
]
_v05_api_graphql_endpoints >> [
    _v05_api_goctopus,
    _v05_api_graphw00f
]
_v19_template_injection >> [
    _n13_nuclei_template_injection,
    _v19_template_injection_tinja
]
_v21_hidden_parameters >> [
    _v21_hidden_parameters_arjun
]
#CLUSTER4
_cluster3 >> _cluster4
_cluster4 >> [
    _v01_cors,
    _v03_csrf,
    _v04_request_smuggling,
    _v18_xss,
    _v20_ssrf,
    _v22_sql_injection
]
_v01_cors >> [
    _v01_cors_misconfiguration_spyhunt,
    _v01_cors_corsy
]
_v03_csrf >> [
    _v03_csrf_xsrfprobe
]
_v04_request_smuggling >> [
    _v04_request_smuggling_smugglefuzz
]
_v18_xss >> [
    _n12_nuclei_xss,
    _v18_xss_gxss
]
_v18_xss_gxss >> _v18_xss_dalfox
_v18_xss_gxss >> _v18_xss_xsstrike   
_v20_ssrf >> [
    _n14_nuclei_ssrf,
    _v20_ssrf_surf
]
_v22_sql_injection >> [
    _n15_nuclei_sql_injection,
    _v22_sql_injection_ghauri
]